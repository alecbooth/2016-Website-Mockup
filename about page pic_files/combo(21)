YUI.add("hermes-template-signup-footer",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"mini-footer"}function d(e,t){return"large-footer"}function v(e,t){return"has-logo"}function m(e,t){return'\n		<div class="close-x"></div>\n	'}function g(e,t){var r="",i,s,o;r+="\n		",o={hash:{},inverse:c.program(12,b,t),fn:c.program(10,y,t),data:t},s=(i=n.isFlipped||e.isFlipped,i?i.call(e,e.flippers,"mini-signup-footer-avatar",o):h.call(e,"isFlipped",e.flippers,"mini-signup-footer-avatar",o));if(s||s===0)r+=s;return r+="\n	",r}function y(e,t){var r="",i;return r+='\n			<div class="avatar person" style="background-image: url(',(i=n.buddyIcon)?i=i.call(e,{hash:{},data:t}):(i=e.buddyIcon,i=typeof i===f?i.apply(e):i),r+=l(i)+')"></div>\n		',r}function b(e,t){return'\n			<div class="logo"></div>\n		'}function w(e,t){return'\n		<div class="logo"></div>\n	'}function E(e,t){return"mini"}function S(e,t){return"large"}function x(e,t){return"miniSignupFooterSignupClick"}function T(e,t){return"signupFooterSignupClick"}function N(e,t){return"miniSignupFooterSigninClick"}function C(e,t){return"signupFooterSigninClick"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="signup-footer ',o=n["if"].call(t,t.isMiniFooter,{hash:{},inverse:c.program(3,d,i),fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;s+=" ",a={hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i},u=(o=n.isNotFlipped||t.isNotFlipped,o?o.call(t,t.flippers,"mini-signup-footer-avatar",a):h.call(t,"isNotFlipped",t.flippers,"mini-signup-footer-avatar",a));if(u||u===0)s+=u;s+='">\n	',a={hash:{},inverse:c.noop,fn:c.program(7,m,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"mini-signup-footer-cancellable",a):h.call(t,"isFlipped",t.flippers,"mini-signup-footer-cancellable",a));if(u||u===0)s+=u;s+="\n	",u=n["if"].call(t,t.isProfilePage,{hash:{},inverse:c.program(14,w,i),fn:c.program(9,g,i),data:i});if(u||u===0)s+=u;s+='\n	<p class="truncate">',(u=n.message)?u=u.call(t,{hash:{},data:i}):(u=t.message,u=typeof u===f?u.apply(t):u),s+=l(u)+'</p>\n	<a href="/signup" class="',u=n["if"].call(t,t.isMiniFooter,{hash:{},inverse:c.program(18,S,i),fn:c.program(16,E,i),data:i});if(u||u===0)s+=u;s+=' butt" data-track="',u=n["if"].call(t,t.isMiniFooter,{hash:{},inverse:c.program(22,T,i),fn:c.program(20,x,i),data:i});if(u||u===0)s+=u;s+='">',a={hash:{intlName:"sohp.SIGN_UP_WITH_YAHOO"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<p class="signin">or <a href="/signin" data-track="',u=n["if"].call(t,t.isMiniFooter,{hash:{},inverse:c.program(26,C,i),fn:c.program(24,N,i),data:i});if(u||u===0)s+=u;return s+='">',a={hash:{intlName:"common.SIGN_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"</a><p>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/signup-footer",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("signup-footer-view",function(e,t){"use strict";var n=200;e.namespace("Views").SignUpFooterView=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.set("pageNSID",e.nsid),this.set("groupID",e.groupId),this.set("pageType",e.pageType!==undefined?e.pageType:"profile"),this.set("messageIntlName",e.messageIntlName),this.set("query",e.searchTerm),this.appContext.flipper.isFlipped("enable-large-sign-up-footer")?(this.set("modalType",""),this.set("beaconPrefix","signupFooter")):(this.set("modalType","mini"),this.set("beaconPrefix","miniSignupFooter"))},loadState:function(){var t=this;return this.get("pageType")==="profile"?this.appContext.getModel("person-models",this.get("pageNSID")).then(function(e){t.set("personModel",e)}):this.get("pageType")==="group"?this.appContext.getModel("group-info-models",this.get("groupID")).then(function(e){t.set("groupModel",e)}):e.Promise.resolve()},buildContainer:function(){var t,n={isProfilePage:this.get("pageType")==="profile"||this.get("pageType")==="group"};return this.get("pageType")==="profile"?(n.buddyIcon=this.appContext.flipper.isFlipped("mini-signup-footer-avatar")?this.get("personModel").getValue("buddyicon").default:"",n.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE",username:e.flutil.unescape(this.get("personModel").getValue("displayname"))})):this.get("pageType")==="explore"?n.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE"}):this.get("pageType")==="group"?(n.buddyIcon=this.appContext.flipper.isFlipped("mini-signup-footer-avatar")?this.get("groupModel").getValue("group").getValue("bestIconURL"):"",n.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE",username:e.flutil.unescape(this.get("groupModel").getValue("group").getValue("title"))})):n.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_SEARCH",query:this.get("query")}),this.get("modalType")==="mini"&&(n.isMiniFooter=!0),t=this.templates("signup-footer")(n),this.setContainerHTML(t),this},activate:function(){this.set("showPopup",!0),this.get("showPopup")&&(this.initialScroll=e.config.win.pageYOffset,this.signupFooterNode=this.get("container").one(".signup-footer"),this.signupFooterHeight=parseInt(this.signupFooterNode.getStyle("height"),10),this.registerEventHandler(e.globalEvents.subscribe("window:scroll:nothrottle",this.handleScroll.bind(this)))),this.appContext.flipper.isFlipped("mini-signup-footer-cancellable")&&this.get("container").one(".close-x")&&this.registerEventHandler(this.get("container").one(".close-x").on("click",this.handleCancelClick.bind(this))),this.footerContainer=e.one(".footer-full-view"),this.footer=this.footerContainer?e.one("footer.foot"):null},showMiniSignupFooter:function(){var t,n=e.StorageHelper.getItem("miniSignupFooterSeen"),r;return n?(n=e.moment(n,"x"),r=e.moment().subtract(1,"days"),r>n&&(t=!0)):t=!0,t},handleCancelClick:function(n){this.signupFooterNode&&(this.signupFooterNode.removeClass("show"),this.signupFooterNode.removeClass("footer-bottom")),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"CancelClick"),this.set("showPopup",!1)},handleScroll:function(r){if(!this.get("showPopup"))return;var i=e.config.win.pageYOffset-this.initialScroll,s=i-n,o;Math.abs(i)>n||i<=0?Math.abs(this.signupFooterHeight-s)>=0&&i>0&&(this.signupFooterNode.hasClass("show")||(this.signupFooterNode.addClass("show"),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"Show"))):this.signupFooterNode.hasClass("show")&&!this.appContext.flipper.isFlipped("mini-signup-footer-cancellable")&&(this.signupFooterNode.removeClass("show"),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"Hide")),o=e.config.win.pageYOffset+this.appContext.viewportData.getHeight(),this.footerContainer.getComputedStyle("display")!=="none"&&o>=this.footer.getY()?this.signupFooterNode.hasClass("footer-bottom")||this.signupFooterNode.addClass("footer-bottom"):this.signupFooterNode.removeClass("footer-bottom")}},{ATTRS:{isActiveViewAgnostic:{value:!0}}})},"@VERSION@",{requires:["flickr-view","hermes-template-signup-footer","signup-footer-css","storage-helper","moment","flutil"],optionalRequires:["global-events"],langBundles:["common","sohp","growth"]});
